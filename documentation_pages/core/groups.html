<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9.1.2. Core objects: Containers — MDAnalysis.core.groups &#8212; MDAnalysis 0.17.0-dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.17.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.17.0-dev documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9.2.1. Core Topology object — MDAnalysis.core.topology" href="topology.html" />
    <link rel="prev" title="9.1.1. Core object: Universe — MDAnalysis.core.universe" href="universe.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.core.groups"></span><div class="section" id="core-objects-containers-mdanalysis-core-groups">
<h1>9.1.2. Core objects: Containers &#8212; <a class="reference internal" href="#module-MDAnalysis.core.groups" title="MDAnalysis.core.groups"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.core.groups</span></code></a><a class="headerlink" href="#core-objects-containers-mdanalysis-core-groups" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> instance contains all
the particles in the system (which MDAnalysis calls
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a>). Groups of atoms are handled as <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>
instances. The <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> is probably the most important
object in MDAnalysis because virtually everything can be accessed
through it. <cite>AtomGroup</cite> instances can be easily created (e.g., from a
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">AtomGroup.select_atoms()</span></code></a> selection or just by slicing).</p>
<p>For convenience, chemically meaningful groups of atoms such as a
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal"><span class="pre">Residue</span></code></a> or a <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal"><span class="pre">Segment</span></code></a> (typically a whole molecule or
all of the solvent) also exist as containers, as well as groups of
these units ((<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></code></a>).</p>
<div class="section" id="classes">
<h2>9.1.2.1. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="collections">
<h3>9.1.2.1.1. Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="MDAnalysis.core.groups.AtomGroup">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">AtomGroup</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>A group of atoms.</p>
<p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> is an ordered collection of atoms. Typically, an
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> is generated from a selection, or by indexing/slicing
the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> of all atoms in the <code class="xref py py-class docutils literal"><span class="pre">Universe</span></code> at
<code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.core.universe.Universe.atoms</span></code>.</p>
<p>An AtomGroup can be indexed and sliced like a list:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>will return the first and the last <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> in the group whereas the
slice</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>returns an AtomGroup of every second element, corresponding to indices 0,
2, and 4.</p>
<p>It also supports &#8220;advanced slicing&#8221; when the argument is a
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a> or a <code class="xref py py-class docutils literal"><span class="pre">list</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aslice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ag</span><span class="p">[</span><span class="n">aslice</span><span class="p">]</span>
</pre></div>
</div>
<p>will return a new AtomGroup of atoms with those indices in the old
AtomGroup.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">AtomGroups originating from a selection are sorted and
duplicate elements are removed. This is not true for AtomGroups
produced by slicing. Thus slicing can be used when the order of
atoms is crucial (for instance, in order to define angles or
dihedrals).</p>
</div>
<p>AtomGroups can be compared and combined using group operators. For
instance, AtomGroups can be concatenated using <cite>+</cite> or <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ag_concat</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag_concat = ag1.concatenate(ag2)</span>
</pre></div>
</div>
<p>When groups are concatenated, the order of the atoms is conserved. If atoms
appear several times in one of the groups, the duplicates are kept in the
resulting group. On the contrary to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.union" title="MDAnalysis.core.groups.AtomGroup.union"><code class="xref py py-meth docutils literal"><span class="pre">union()</span></code></a>
treats the AtomGroups as sets, duplicates are removed from the resulting
group, and atoms are ordered. The <cite>|</cite> operator is synomymous to
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.union" title="MDAnalysis.core.groups.AtomGroup.union"><code class="xref py py-meth docutils literal"><span class="pre">union()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ag_union</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag_union = ag1.union(ag2)</span>
</pre></div>
</div>
<p>The opposite operation to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a> is <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>. This
method creates a new group with all the atoms of the group that are not in
a given other group; the order of the atoms is kept, so as duplicates.
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> is the set version of <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>. The resulting
group is sorted and deduplicated.</p>
<p>All set methods are listed in the table below. These methods treat the
groups as sorted and deduplicated sets of atoms.</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="17%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operation</th>
<th class="head">Equivalent</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">s.isdisjoint(t)</span></code></td>
<td>&#160;</td>
<td><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">s</span></code> and
<code class="docutils literal"><span class="pre">t</span></code> do not share
elements</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s.issubset(t)</span></code></td>
<td>&#160;</td>
<td>test if all elements of
<code class="docutils literal"><span class="pre">s</span></code> are part of <code class="docutils literal"><span class="pre">t</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">s.is_strict_subset(t)</span></code></td>
<td>&#160;</td>
<td>test if all elements of
<code class="docutils literal"><span class="pre">s</span></code> are part of <code class="docutils literal"><span class="pre">t</span></code>,
and <code class="docutils literal"><span class="pre">s</span> <span class="pre">!=</span> <span class="pre">t</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s.issuperset(t)</span></code></td>
<td>&#160;</td>
<td>test if all elements of
<code class="docutils literal"><span class="pre">t</span></code> are part of <code class="docutils literal"><span class="pre">s</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">s.is_strict_superset(t)</span></code></td>
<td>&#160;</td>
<td>test if all elements of
<code class="docutils literal"><span class="pre">t</span></code> are part of <code class="docutils literal"><span class="pre">s</span></code>,
and <code class="docutils literal"><span class="pre">s</span> <span class="pre">!=</span> <span class="pre">t</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s.union(t)</span></code></td>
<td><code class="docutils literal"><span class="pre">s</span> <span class="pre">|</span> <span class="pre">t</span></code></td>
<td>new Group with elements
from both <code class="docutils literal"><span class="pre">s</span></code> and <code class="docutils literal"><span class="pre">t</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">s.intersection(t)</span></code></td>
<td><code class="docutils literal"><span class="pre">s</span> <span class="pre">&amp;</span> <span class="pre">t</span></code></td>
<td>new Group with elements
common to <code class="docutils literal"><span class="pre">s</span></code> and <code class="docutils literal"><span class="pre">t</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s.difference(t)</span></code></td>
<td><code class="docutils literal"><span class="pre">s</span> <span class="pre">-</span> <span class="pre">t</span></code></td>
<td>new Group with elements of
<code class="docutils literal"><span class="pre">s</span></code> that are not in <code class="docutils literal"><span class="pre">t</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">s.symmetric_difference(t)</span></code></td>
<td><code class="docutils literal"><span class="pre">s</span> <span class="pre">^</span> <span class="pre">t</span></code></td>
<td>new Group with elements
that are part of <code class="docutils literal"><span class="pre">s</span></code> or
<code class="docutils literal"><span class="pre">t</span></code> but not both</td>
</tr>
</tbody>
</table>
<p>The following methods keep the order of the atoms, and keep duplicated
atoms.</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="17%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operation</th>
<th class="head">Equivalent</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">len(s)</span></code></td>
<td>&#160;</td>
<td>number of elements (atoms,
residues or segment) in
the group</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s</span> <span class="pre">==</span> <span class="pre">t</span></code></td>
<td>&#160;</td>
<td>test if <code class="docutils literal"><span class="pre">s</span></code> and <code class="docutils literal"><span class="pre">t</span></code>
contain the same elements
in the same order</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">s.concatenate(t)</span></code></td>
<td><code class="docutils literal"><span class="pre">s</span> <span class="pre">+</span> <span class="pre">t</span></code></td>
<td>new Group with elements
from <code class="docutils literal"><span class="pre">s</span></code> and from <code class="docutils literal"><span class="pre">t</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">s.subtract(t)</span></code></td>
<td>&#160;</td>
<td>new Group with elements
from <code class="docutils literal"><span class="pre">s</span></code> that are not
in <code class="docutils literal"><span class="pre">t</span></code></td>
</tr>
</tbody>
</table>
<p>The <cite>in</cite> operator allows to test if an <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> is in the AtomGroup.</p>
<p>AtomGroup instances are always bound to a
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.universe.Universe</span></code></a>. They cannot exist in isolation.</p>
<p class="rubric">Deprecated functionality</p>
<p><em>Instant selectors</em> will be removed in the 1.0 release.  See issue <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/1377">#1377</a> for more details.</p>
<p>Atoms can also be accessed in a Pythonic fashion by using the atom name as
an attribute. For instance,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="o">.</span><span class="n">CA</span>
</pre></div>
</div>
<p>will provide a <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> of all CA atoms in the
group. These <em>instant selector</em> attributes are auto-generated for
each atom name encountered in the group.</p>
<p class="rubric">Notes</p>
<p>The name-attribute instant selector access to atoms is mainly
meant for quick interactive work. Thus it either returns a
single <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> if there is only one matching atom, <em>or</em> a
new <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> for multiple matches.  This makes it
difficult to use the feature consistently in scripts.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.universe.Universe</span></code></a></p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of AtomGroup will be removed in the 1.0 release.
See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details and alternatives.</p>
</div>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.angle">
<code class="descname">angle</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>This AtomGroup represented as an Angle object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.Angle" title="MDAnalysis.core.topologyobjects.Angle"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.topologyobjects.Angle</span></code></a> object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><cite>ValueError</cite> if the AtomGroup is not length 3</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another AtomGroup identical to this one.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.bbox">
<code class="descname">bbox</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding box of the selection.</p>
<p>The lengths A,B,C of the orthorhombic enclosing box are</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">bbox</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, move all atoms within the primary unit cell before
calculation. [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>corners</strong> &#8211; 2x3 array giving corners of bounding box as
[[xmin, ymin, zmin], [xmax, ymax, zmax]].</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.bond">
<code class="descname">bond</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.bond" title="Permalink to this definition">¶</a></dt>
<dd><p>This AtomGroup represented as a Bond object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.Bond" title="MDAnalysis.core.topologyobjects.Bond"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.topologyobjects.Bond</span></code></a> object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><cite>ValueError</cite> if the AtomGroup is not length 2</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.bsphere">
<code class="descname">bsphere</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.bsphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding sphere of the selection.</p>
<p>The sphere is calculated relative to the centre of geometry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, move all atoms within the primary unit cell before
calculation. [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>R</strong> (<em>float</em>) &#8211; Radius of bounding sphere.</li>
<li><strong>center</strong> (<em>array</em>) &#8211; Coordinates of sphere center as <code class="docutils literal"><span class="pre">[xcen,ycen,zcen]</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.center">
<code class="descname">center</code><span class="sig-paren">(</span><em>weights</em>, <em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate center of group given some weights</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>weights</strong> (<em>array_like</em>) &#8211; weights to be used</li>
<li><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>center</strong> &#8211; weighted center of group</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To find the charge weighted center of a given Atomgroup:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.center_of_geometry">
<code class="descname">center_of_geometry</code><span class="sig-paren">(</span><em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry (also known as centroid) of the selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>center</strong> &#8211; geometric center of group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry (also known as centroid) of the selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>center</strong> &#8211; geometric center of group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.concatenate">
<code class="descname">concatenate</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate with another Group or Component of the same level.</p>
<p>Duplicate entries and original order is preserved. It is synomymous to
the <cite>+</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with elements of <cite>self</cite> and <cite>other</cite> concatenated</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>The order of the original contents (including duplicates)
are preserved when performing a concatenation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag1.concatenate(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;O&#39;, &#39;O&#39;, &#39;O&#39;], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;N&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.difference">
<code class="descname">difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Elements from this Group that do not appear in another</p>
<p>This method removes duplicate elements and sorts the result. As such,
it is different from <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>. <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> is synomymous
to the <cite>-</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.symmetric_difference" title="MDAnalysis.core.groups.AtomGroup.symmetric_difference"><code class="xref py py-meth docutils literal"><span class="pre">symmetric_difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.dihedral">
<code class="descname">dihedral</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>This AtomGroup represented as a Dihedral object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.Dihedral" title="MDAnalysis.core.topologyobjects.Dihedral"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.topologyobjects.Dihedral</span></code></a> object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><cite>ValueError</cite> if the AtomGroup is not length 4</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.forces">
<code class="descname">forces</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces on each atom in the AtomGroup.</p>
<p>The velocities can be changed by assigning an array of the appropriate
shape, i.e. either Nx3 to assign individual velocities or 3 to assign
the <em>same</em> velocity to all atoms (e.g. <code class="docutils literal"><span class="pre">ag.velocity</span> <span class="pre">=</span> <span class="pre">array([0,0,0])</span></code>
will give all particles zero velocity).</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.groupby">
<code class="descname">groupby</code><span class="sig-paren">(</span><em>topattr</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together items in this group according to values of <em>topattr</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topattr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Topology attribute to group components by.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Unique values of the topology attribute as keys, Groups as values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>To group atoms with the same mass together:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
<span class="go">{12.010999999999999: &lt;AtomGroup with 462 atoms&gt;,</span>
<span class="go">14.007: &lt;AtomGroup with 116 atoms&gt;,</span>
<span class="go">15.999000000000001: &lt;AtomGroup with 134 atoms&gt;}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.guess_bonds">
<code class="descname">guess_bonds</code><span class="sig-paren">(</span><em>vdwradii=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.guess_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.guess_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess bonds that exist within this AtomGroup and add to Universe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vdwradii</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em>, </em><em>optional</em>) &#8211; Dict relating atom type: vdw radii</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../topology/guessers.html#MDAnalysis.topology.guessers.guess_bonds" title="MDAnalysis.topology.guessers.guess_bonds"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.topology.guessers.guess_bonds()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.improper">
<code class="descname">improper</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.improper" title="Permalink to this definition">¶</a></dt>
<dd><p>This AtomGroup represented as an ImproperDihedral object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.ImproperDihedral" title="MDAnalysis.core.topologyobjects.ImproperDihedral"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.topologyobjects.ImproperDihedral</span></code></a> object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><cite>ValueError</cite> if the AtomGroup is not length 4</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are in both this Group and another</p>
<p>This method removes duplicate elements and sorts the result. It is
synomymous to the <cite>&amp;</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the common elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Intersections can be used when the select atoms string would
become too complicated.  For example to find the water atoms
which are within 4.0A of two segments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell1</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;around 4.0 segid 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell2</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;around 4.0 segid 2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">common</span> <span class="o">=</span> <span class="n">shell1</span> <span class="o">&amp;</span> <span class="n">shell2</span>  <span class="c1"># or shell1.intersection(shell2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.union" title="MDAnalysis.core.groups.AtomGroup.union"><code class="xref py py-meth docutils literal"><span class="pre">union()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.is_strict_subset">
<code class="descname">is_strict_subset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.is_strict_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a subset of another Group but not identical</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a strict subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.is_strict_superset">
<code class="descname">is_strict_superset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.is_strict_superset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a superset of another Group but not identical</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a strict superset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.isdisjoint">
<code class="descname">isdisjoint</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>If the Group has no elements in common with the other Group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if the two Groups do not have common elements</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.issubset">
<code class="descname">issubset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of this Group are part of another Group</p>
<p>Note that an empty group is a subset of any group of the same level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.issuperset">
<code class="descname">issuperset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of another Group are part of this Group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.ix">
<code class="descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<ul class="simple">
<li>If this Group is an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>, these are the
indices of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> instances.</li>
<li>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal"><span class="pre">Residue</span></code></a> instances.</li>
<li>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal"><span class="pre">Segment</span></code></a> instances.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.ix_array">
<code class="descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<p>For a Group, ix_array is the same as ix. This method gives a
consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ix" title="MDAnalysis.core.groups.AtomGroup.ix"><code class="xref py py-obj docutils literal"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms in AtomGroup.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self)</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.n_residues">
<code class="descname">n_residues</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.n_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unique residues represented in the AtomGroup.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self.residues)</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.n_segments">
<code class="descname">n_segments</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.n_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unique segments represented in the AtomGroup.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self.segments)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.pack_into_box">
<code class="descname">pack_into_box</code><span class="sig-paren">(</span><em>box=None</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift all atoms in this group to be within the primary unit cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>box</strong> (<em>array_like</em>) &#8211; Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>, uses these
timestep dimensions.</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; <code class="docutils literal"><span class="pre">True</span></code> to change coordinates in place.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> &#8211; Shifted atom coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>All atoms will be moved so that they lie between 0 and boxlength
<span class="math">\(L_i\)</span> in all dimensions, i.e. the lower left corner of the
simulation box is taken to be at (0,0,0):</p>
<div class="math">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\]</div>
<p>The default is to take unit cell information from the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> instance. The optional
argument <cite>box</cite> can be used to provide alternative unit cell information
(in the MDAnalysis standard format <code class="docutils literal"><span class="pre">[Lx,</span> <span class="pre">Ly,</span> <span class="pre">Lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span>
<span class="pre">gamma]</span></code>).</p>
<p>Works with either orthogonal or triclinic box types.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.positions">
<code class="descname">positions</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates of the atoms in the AtomGroup.</p>
<p>The positions can be changed by assigning an array of the appropriate
shape, i.e. either Nx3 to assign individual coordinates or 3, to assign
the <em>same</em> coordinate to all atoms (e.g. <code class="docutils literal"><span class="pre">ag.positions</span> <span class="pre">=</span>
<span class="pre">array([0,0,0])</span></code> will move all particles to the origin).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Changing the position is not reflected in any files;
reading any frame from the trajectory will replace
the change with that from the file <em>except</em> if the
trajectory is held in memory, e.g., when the
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe.transfer_to_memory" title="MDAnalysis.core.universe.Universe.transfer_to_memory"><code class="xref py py-class docutils literal"><span class="pre">transfer_to_memory</span></code></a>
method was used.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.residues">
<code class="descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sorted <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a> of the (unique) residues
represented in the AtomGroup.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>R</em>, <em>point=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation matrix <cite>R</cite> to the selection&#8217;s coordinates.
<span class="math">\(\mathsf{R}\)</span> is a 3x3 orthogonal matrix that transforms a vector
<span class="math">\(\mathbf{x} \rightarrow \mathbf{x}'\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\mathbf{x}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>R</strong> (<em>array_like</em>) &#8211; 3x3 rotation matrix to use for applying rotation.</li>
<li><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) &#8211; Center of rotation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>By default rotates around center of origin <code class="docutils literal"><span class="pre">point=(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>. To
rotate around center of geometry of the atomgroup use <code class="docutils literal"><span class="pre">ag.rotate(R,</span>
<span class="pre">point=ag.centroid)</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.rotateby" title="MDAnalysis.core.groups.AtomGroup.rotateby"><code class="xref py py-meth docutils literal"><span class="pre">rotateby()</span></code></a></dt>
<dd>rotate around given axis and angle</dd>
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.rotateby">
<code class="descname">rotateby</code><span class="sig-paren">(</span><em>angle</em>, <em>axis</em>, <em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.rotateby" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation to the selection&#8217;s coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Rotation angle in degrees.</li>
<li><strong>axis</strong> (<em>array_like</em>) &#8211; Rotation axis vector.</li>
<li><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) &#8211; Center of rotation. If <code class="docutils literal"><span class="pre">None</span></code> then the center of geometry of this
group is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The transformation from current coordinates <span class="math">\(\mathbf{x}\)</span>
to new coordinates <span class="math">\(\mathbf{x}'\)</span> is</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\,(\mathbf{x}-\mathbf{p}) + \mathbf{p}\]</div>
<p>where <span class="math">\(\mathsf{R}\)</span> is the rotation by <cite>angle</cite> around the
<cite>axis</cite> going through <cite>point</cite> <span class="math">\(\mathbf{p}\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations.rotation_matrix()</span></code></dt>
<dd>calculate <span class="math">\(\mathsf{R}\)</span></dd>
</dl>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.segments">
<code class="descname">segments</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sorted <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></code></a> of the (unique) segments
represented in the AtomGroup.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.select_atoms">
<code class="descname">select_atoms</code><span class="sig-paren">(</span><em>sel</em>, <em>*othersel</em>, <em>**selgroups</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.select_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms using a selection string.</p>
<p>Returns an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> with atoms sorted according to
their index in the topology (this is to ensure that there
are not any duplicates, which can happen with complicated
selections).</p>
<p>Existing <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> objects can be passed as named arguments,
which will then be available to the selection parser.</p>
<p>Subselections can be grouped with parentheses.</p>
<p>Selections can be set to update automatically on frame change, by
setting the <cite>updating</cite> named argument to <cite>True</cite>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;segid DMPC and not ( name H* or name O* )&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span>
<span class="go">&lt;AtomGroup with 3420 atoms&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;around 10 group notHO&quot;</span><span class="p">,</span> <span class="n">notHO</span><span class="o">=</span><span class="n">sel</span><span class="p">)</span>
<span class="go">&lt;AtomGroup with 1250 atoms&gt;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If exact ordering of atoms is required (for instance, for
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.angle" title="MDAnalysis.core.groups.AtomGroup.angle"><code class="xref py py-meth docutils literal"><span class="pre">angle()</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.dihedral" title="MDAnalysis.core.groups.AtomGroup.dihedral"><code class="xref py py-meth docutils literal"><span class="pre">dihedral()</span></code></a>
calculations) then one supplies selections <em>separately</em> in the
required order. Also, when multiple <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>
instances are concatenated with the <code class="docutils literal"><span class="pre">+</span></code> operator then the
order of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> instances is preserved and duplicates
are not removed.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../selections.html#selection-commands-label"><span class="std std-ref">Selection commands</span></a></p>
</div>
<p class="rubric">Selection syntax</p>
<p>The selection parser understands the following CASE SENSITIVE
<em>keywords</em>:</p>
<p><strong>Simple selections</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>protein, backbone, nucleic, nucleicbackbone</dt>
<dd>selects all atoms that belong to a standard set of residues;
a protein is identfied by a hard-coded set of residue names so
it  may not work for esoteric residues.</dd>
<dt>segid <em>seg-name</em></dt>
<dd>select by segid (as given in the topology), e.g. <code class="docutils literal"><span class="pre">segid</span> <span class="pre">4AKE</span></code>
or <code class="docutils literal"><span class="pre">segid</span> <span class="pre">DMPC</span></code></dd>
<dt>resid <em>residue-number-range</em></dt>
<dd>resid can take a single residue number or a range of numbers. A
range consists of two numbers separated by a colon (inclusive)
such as <code class="docutils literal"><span class="pre">resid</span> <span class="pre">1:5</span></code>. A residue number (&#8220;resid&#8221;) is taken
directly from the topology.
If icodes are present in the topology, then these will be
taken into account.  Ie &#8216;resid 163B&#8217; will only select resid
163 with icode B while &#8216;resid 163&#8217; will select only residue 163.
Range selections will also respect icodes, so &#8216;resid 162-163B&#8217;
will select all residues in 162 and those in 163 up to icode B.</dd>
<dt>resnum <em>resnum-number-range</em></dt>
<dd>resnum is the canonical residue number; typically it is set to
the residue id in the original PDB structure.</dd>
<dt>resname <em>residue-name</em></dt>
<dd>select by residue name, e.g. <code class="docutils literal"><span class="pre">resname</span> <span class="pre">LYS</span></code></dd>
<dt>name <em>atom-name</em></dt>
<dd>select by atom name (as given in the topology). Often, this is
force field dependent. Example: <code class="docutils literal"><span class="pre">name</span> <span class="pre">CA</span></code> (for C&amp;alpha; atoms)
or <code class="docutils literal"><span class="pre">name</span> <span class="pre">OW</span></code> (for SPC water oxygen)</dd>
<dt>type <em>atom-type</em></dt>
<dd>select by atom type; this is either a string or a number and
depends on the force field; it is read from the topology file
(e.g. the CHARMM PSF file contains numeric atom types). It has
non-sensical values when a PDB or GRO file is used as a topology</dd>
<dt>atom <em>seg-name</em>  <em>residue-number</em>  <em>atom-name</em></dt>
<dd>a selector for a single atom consisting of segid resid atomname,
e.g. <code class="docutils literal"><span class="pre">DMPC</span> <span class="pre">1</span> <span class="pre">C2</span></code> selects the C2 carbon of the first residue of
the DMPC segment</dd>
<dt>altloc <em>alternative-location</em></dt>
<dd>a selection for atoms where alternative locations are available,
which is often the case with high-resolution crystal structures
e.g. <cite>resid 4 and resname ALA and altloc B</cite> selects only the
atoms of ALA-4 that have an altloc B record.</dd>
<dt>moltype <em>molecule-type</em></dt>
<dd>select by molecule type, e.g. <code class="docutils literal"><span class="pre">moltype</span> <span class="pre">Protein_A</span></code>. At the
moment, only the TPR format defines the molecule type.</dd>
</dl>
</div></blockquote>
<p><strong>Boolean</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>not</dt>
<dd>all atoms not in the selection, e.g. <code class="docutils literal"><span class="pre">not</span> <span class="pre">protein</span></code> selects
all atoms that aren&#8217;t part of a protein</dd>
<dt>and, or</dt>
<dd>combine two selections according to the rules of boolean
algebra, e.g. <code class="docutils literal"><span class="pre">protein</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">(resname</span> <span class="pre">ALA</span> <span class="pre">or</span> <span class="pre">resname</span> <span class="pre">LYS)</span></code>
selects all atoms that belong to a protein, but are not in a
lysine or alanine residue</dd>
</dl>
</div></blockquote>
<p><strong>Geometric</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>around <em>distance</em>  <em>selection</em></dt>
<dd>selects all atoms a certain cutoff away from another selection,
e.g. <code class="docutils literal"><span class="pre">around</span> <span class="pre">3.5</span> <span class="pre">protein</span></code> selects all atoms not belonging to
protein that are within 3.5 Angstroms from the protein</dd>
<dt>point <em>x</em> <em>y</em> <em>z</em>  <em>distance</em></dt>
<dd>selects all atoms within a cutoff of a point in space, make sure
coordinate is separated by spaces,
e.g. <code class="docutils literal"><span class="pre">point</span> <span class="pre">5.0</span> <span class="pre">5.0</span> <span class="pre">5.0</span>&#160; <span class="pre">3.5</span></code> selects all atoms within 3.5
Angstroms of the coordinate (5.0, 5.0, 5.0)</dd>
<dt>prop [abs] <em>property</em>  <em>operator</em>  <em>value</em></dt>
<dd>selects atoms based on position, using <em>property</em>  <strong>x</strong>, <strong>y</strong>,
or <strong>z</strong> coordinate. Supports the <strong>abs</strong> keyword (for absolute
value) and the following <em>operators</em>: <strong>&lt;, &gt;, &lt;=, &gt;=, ==, !=</strong>.
For example, <code class="docutils literal"><span class="pre">prop</span> <span class="pre">z</span> <span class="pre">&gt;=</span> <span class="pre">5.0</span></code> selects all atoms with z
coordinate greater than 5.0; <code class="docutils literal"><span class="pre">prop</span> <span class="pre">abs</span> <span class="pre">z</span> <span class="pre">&lt;=</span> <span class="pre">5.0</span></code> selects all
atoms within -5.0 &lt;= z &lt;= 5.0.</dd>
<dt>sphzone <em>radius</em> <em>selection</em></dt>
<dd>Selects all atoms that are within <em>radius</em> of the center of
geometry of <em>selection</em></dd>
<dt>sphlayer <em>inner radius</em> <em>outer radius</em> <em>selection</em></dt>
<dd>Similar to sphzone, but also excludes atoms that are within
<em>inner radius</em> of the selection COG</dd>
</dl>
</div></blockquote>
<p><strong>Connectivity</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>byres <em>selection</em></dt>
<dd>selects all atoms that are in the same segment and residue as
selection, e.g. specify the subselection after the byres keyword</dd>
<dt>bonded <em>selection</em></dt>
<dd>selects all atoms that are bonded to selection
eg: <code class="docutils literal"><span class="pre">select</span> <span class="pre">name</span> <span class="pre">H</span> <span class="pre">bonded</span> <span class="pre">name</span> <span class="pre">O</span></code> selects only hydrogens
bonded to oxygens</dd>
</dl>
</div></blockquote>
<p><strong>Index</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>bynum <em>index-range</em></dt>
<dd>selects all atoms within a range of (1-based) inclusive indices,
e.g. <code class="docutils literal"><span class="pre">bynum</span> <span class="pre">1</span></code> selects the first atom in the universe;
<code class="docutils literal"><span class="pre">bynum</span> <span class="pre">5:10</span></code> selects atoms 5 through 10 inclusive. All atoms
in the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.Universe</span></code> are consecutively numbered,
and the index runs from 1 up to the total number of atoms.</dd>
</dl>
</div></blockquote>
<p><strong>Preexisting selections</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>group <cite>group-name</cite></dt>
<dd>selects the atoms in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> passed to the
function as an argument named <cite>group-name</cite>. Only the atoms
common to <cite>group-name</cite> and the instance
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">select_atoms()</span></code></a>
was called from will be considered, unless <code class="docutils literal"><span class="pre">group</span></code> is
preceded by the <code class="docutils literal"><span class="pre">global</span></code> keyword. <cite>group-name</cite> will be
included in the parsing just by comparison of atom indices.
This means that it is up to the user to make sure the
<cite>group-name</cite> group was defined in an appropriate
<code class="xref py py-class docutils literal"><span class="pre">Universe</span></code>.</dd>
<dt>global <em>selection</em></dt>
<dd>by default, when issuing
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">select_atoms()</span></code></a> from an
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>, selections and
subselections are returned intersected with the atoms of that
instance. Prefixing a selection term with <code class="docutils literal"><span class="pre">global</span></code> causes its
selection to be returned in its entirety.  As an example, the
<code class="docutils literal"><span class="pre">global</span></code> keyword allows for
<code class="docutils literal"><span class="pre">lipids.select_atoms(&quot;around</span> <span class="pre">10</span> <span class="pre">global</span> <span class="pre">protein&quot;)</span></code> &#8212; where
<code class="docutils literal"><span class="pre">lipids</span></code> is a group that does not contain any proteins. Were
<code class="docutils literal"><span class="pre">global</span></code> absent, the result would be an empty selection since
the <code class="docutils literal"><span class="pre">protein</span></code> subselection would itself be empty. When issuing
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">select_atoms()</span></code></a> from a
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>, <code class="docutils literal"><span class="pre">global</span></code> is ignored.</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt><strong>Dynamic selections</strong></dt>
<dd>If <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">select_atoms()</span></code></a> is
invoked with named argument <cite>updating</cite> set to <cite>True</cite>, an
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal"><span class="pre">UpdatingAtomGroup</span></code></a> instance will be
returned, instead of a regular
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>. It behaves just like
the latter, with the difference that the selection expressions are
re-evaluated every time the trajectory frame changes (this happens
lazily, only when the
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal"><span class="pre">UpdatingAtomGroup</span></code></a> is accessed so
that there is no redundant updating going on).
Issuing an updating selection from an already updating group will
cause later updates to also reflect the updating of the base group.
A non-updating selection or a slicing operation made on an
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal"><span class="pre">UpdatingAtomGroup</span></code></a> will return a
static <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>, which will no
longer update across frames.</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.4: </span>Added <em>resnum</em> selection.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8.1: </span>Added <em>group</em> and <em>fullgroup</em> selections.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.11: </span>The use of <code class="docutils literal"><span class="pre">fullgroup</span></code> has been deprecated in favor of the equivalent
<code class="docutils literal"><span class="pre">global</span> <span class="pre">group</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.13.0: </span>Added <em>bonded</em> selection</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.16.0: </span>Resid selection now takes icodes into account where present.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0: </span>Updating selections now possible by setting the <code class="docutils literal"><span class="pre">updating</span></code> argument.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.17.0: </span>Added <em>moltype</em> selection.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.split">
<code class="descname">split</code><span class="sig-paren">(</span><em>level</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split AtomGroup into a list of atomgroups by <cite>level</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>level</strong> (<em>{'atom'</em><em>, </em><em>'residue'</em><em>, </em><em>'segment'}</em>) &#8211; </td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.subtract">
<code class="descname">subtract</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Group with elements from this Group that don&#8217;t appear in other</p>
<p>The original order of this group is kept, as well as any duplicate
elements. If an element of this Group is duplicated and appears in
the other Group or Component, then all the occurences of that element
are removed from the returned Group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>,
conserves order and duplicates.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Unlike <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> this method will not sort or remove
duplicates.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">-</span> <span class="n">ag2</span>  <span class="c1"># or ag1.subtract(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span><span class="o">.</span><span class="n">indices</span>
<span class="go">array([3, 3, 1, 1])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.symmetric_difference">
<code class="descname">symmetric_difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are only in one of this Group or another</p>
<p>This method removes duplicate elements and the result is sorted. It is
synomym to the <cite>^</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements that are in <cite>self</cite> or in <cite>other</cite> but not in
both, without duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">^</span> <span class="n">ag2</span>  <span class="c1"># or ag1.symmetric_difference(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="o">.</span><span class="n">indices</span>  <span class="c1"># 0 and 1 are only in ag1, 4 and 6 are only in ag2</span>
<span class="go">[0, 1, 4, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply homogenous transformation matrix <cite>M</cite> to the coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; 4x4 matrix, with the rotation in <code class="docutils literal"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">M[:3,:3]</span></code> and the
translation in <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">M[:3,3]</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation <span class="math">\(\mathsf{R}\)</span> is applied before the translation
<span class="math">\(\mathbf{t}\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply translation vector <cite>t</cite> to the selection&#8217;s coordinates.</p>
<p>Atom coordinates are translated in-place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> (<em>array_like</em>) &#8211; vector to translate coordinates with</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The method applies a translation to the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>
from current coordinates <span class="math">\(\mathbf{x}\)</span> to new coordinates
<span class="math">\(\mathbf{x}'\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.ts">
<code class="descname">ts</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporary Timestep that contains the selection coordinates.</p>
<p>A <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> instance,
which can be passed to a trajectory writer.</p>
<p>If <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ts" title="MDAnalysis.core.groups.AtomGroup.ts"><code class="xref py py-attr docutils literal"><span class="pre">ts</span></code></a> is modified then these modifications
will be present until the frame number changes (which
typically happens when the underlying trajectory frame
changes).</p>
<p>It is not possible to assign a new
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> to the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ts" title="MDAnalysis.core.groups.AtomGroup.ts"><code class="xref py py-attr docutils literal"><span class="pre">AtomGroup.ts</span></code></a> attribute; change attributes of the object.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.union">
<code class="descname">union</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements either in this Group or another</p>
<p>On the contrary to concatenation, this method sort the elements and
removes duplicate ones. It is synomymous to the <cite>|</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the combined elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>In contrast to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, any duplicates are dropped
and the result is sorted.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag1.union(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;O&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.intersection" title="MDAnalysis.core.groups.AtomGroup.intersection"><code class="xref py py-meth docutils literal"><span class="pre">intersection()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.unique">
<code class="descname">unique</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an AtomGroup containing sorted and unique atoms only.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span>
<span class="go">&lt;AtomGroup with 6 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([2, 1, 2, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">ag</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([0, 1, 2])</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.AtomGroup.velocities">
<code class="descname">velocities</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocities of the atoms in the AtomGroup.</p>
<p>The velocities can be changed by assigning an array of the appropriate
shape, i.e. either Nx3 to assign individual velocities or 3 to assign
the <em>same</em> velocity to all atoms (e.g. <code class="docutils literal"><span class="pre">ag.velocity</span> <span class="pre">=</span> <span class="pre">array([0,0,0])</span></code>
will give all particles zero velocity).</p>
<p>Raises a <code class="xref py py-exc docutils literal"><span class="pre">NoDataError</span></code> if the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> does not contain
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.velocities" title="MDAnalysis.coordinates.base.Timestep.velocities"><code class="xref py py-attr docutils literal"><span class="pre">velocities</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.wrap">
<code class="descname">wrap</code><span class="sig-paren">(</span><em>compound='atoms'</em>, <em>center='com'</em>, <em>box=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the contents of this Group back into the unit cell.</p>
<p>This is a more powerful version of <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal"><span class="pre">pack_into_box()</span></code></a>, allowing
groups of atoms to be kept together through the process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>compound</strong> (<em>{'atoms'</em><em>, </em><em>'group'</em><em>, </em><em>'residues'</em><em>, </em><em>'segments'</em><em>, </em><em>'fragments'}</em>) &#8211; The group which will be kept together through the shifting process.</li>
<li><strong>center</strong> (<em>{'com'</em><em>, </em><em>'cog'}</em>) &#8211; How to define the center of a given group of atoms.</li>
<li><strong>box</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>, uses these
timestep dimensions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>When specifying a <cite>compound</cite>, the translation is calculated based on
each compound. The same translation is applied to all atoms
within this compound, meaning it will not be broken by the shift.
This might however mean that all atoms from the compound are not
inside the unit cell, but rather the center of the compound is.</p>
<p><cite>center</cite> allows the definition of the center of each group to be
specified. This can be either &#8216;com&#8217; for center of mass, or &#8216;cog&#8217; for
center of geometry.</p>
<p><cite>box</cite> allows a unit cell to be given for the transformation. If not
specified, an the dimensions information from the current Timestep will
be used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">wrap with all default keywords is identical to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal"><span class="pre">pack_into_box()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.2.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename=None</em>, <em>file_format='PDB'</em>, <em>filenamefmt='{trjname}_{frame}'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <cite>AtomGroup</cite> to a file.</p>
<p>The output can either be a coordinate file or a selection, depending on
the <cite>format</cite>. Only single-frame coordinate files are supported. If you
need to write out a trajectory, see <code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">None</span></code>: create TRJNAME_FRAME.FORMAT from filenamefmt [<code class="docutils literal"><span class="pre">None</span></code>]</li>
<li><strong>file_format</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) &#8211; PDB, CRD, GRO, VMD (tcl), PyMol (pml), Gromacs (ndx) CHARMM (str)
Jmol (spt); case-insensitive and can also be supplied as the
filename extension [PDB]</li>
<li><strong>filenamefmt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) &#8211; format string for default filename; use substitution tokens
&#8216;trjname&#8217; and &#8216;frame&#8217; [&#8220;%(trjname)s_%(frame)d&#8221;]</li>
<li><strong>bonds</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><em>optional</em>) &#8211; how to handle bond information, especially relevant for PDBs.
<code class="docutils literal"><span class="pre">&quot;conect&quot;</span></code>: write only the CONECT records defined in the original
file. <code class="docutils literal"><span class="pre">&quot;all&quot;</span></code>: write out all bonds, both the original defined and
those guessed by MDAnalysis. <code class="docutils literal"><span class="pre">None</span></code>: do not write out bonds.
Default os <code class="docutils literal"><span class="pre">&quot;conect&quot;</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Merged with write_selection.  This method can now write both
selections out.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.ResidueGroup">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">ResidueGroup</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#ResidueGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>ResidueGroup base class.</p>
<p>This class is used by a <code class="xref py py-class docutils literal"><span class="pre">Universe</span></code> for generating its
Topology-specific <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a> class. All the
<code class="xref py py-class docutils literal"><span class="pre">TopologyAttr</span></code> components are obtained from
<code class="xref py py-class docutils literal"><span class="pre">GroupBase</span></code>, so this class only includes ad-hoc methods
specific to ResidueGroups.</p>
<p>ResidueGroups can be compared and combined using group operators. See the
list of these operators on <code class="xref py py-class docutils literal"><span class="pre">GroupBase</span></code>.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of Segments will be removed in the 1.0 release.
See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details and alternatives.</p>
</div>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> of atoms represented in this
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>.</p>
<p>The atoms are ordered locally by residue in the
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>.  No duplicates are removed.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.bbox">
<code class="descname">bbox</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding box of the selection.</p>
<p>The lengths A,B,C of the orthorhombic enclosing box are</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">bbox</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, move all atoms within the primary unit cell before
calculation. [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>corners</strong> &#8211; 2x3 array giving corners of bounding box as
[[xmin, ymin, zmin], [xmax, ymax, zmax]].</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.bsphere">
<code class="descname">bsphere</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.bsphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding sphere of the selection.</p>
<p>The sphere is calculated relative to the centre of geometry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, move all atoms within the primary unit cell before
calculation. [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>R</strong> (<em>float</em>) &#8211; Radius of bounding sphere.</li>
<li><strong>center</strong> (<em>array</em>) &#8211; Coordinates of sphere center as <code class="docutils literal"><span class="pre">[xcen,ycen,zcen]</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.center">
<code class="descname">center</code><span class="sig-paren">(</span><em>weights</em>, <em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate center of group given some weights</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>weights</strong> (<em>array_like</em>) &#8211; weights to be used</li>
<li><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>center</strong> &#8211; weighted center of group</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To find the charge weighted center of a given Atomgroup:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.center_of_geometry">
<code class="descname">center_of_geometry</code><span class="sig-paren">(</span><em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry (also known as centroid) of the selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>center</strong> &#8211; geometric center of group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry (also known as centroid) of the selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>center</strong> &#8211; geometric center of group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.concatenate">
<code class="descname">concatenate</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate with another Group or Component of the same level.</p>
<p>Duplicate entries and original order is preserved. It is synomymous to
the <cite>+</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with elements of <cite>self</cite> and <cite>other</cite> concatenated</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>The order of the original contents (including duplicates)
are preserved when performing a concatenation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag1.concatenate(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;O&#39;, &#39;O&#39;, &#39;O&#39;], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;N&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.difference">
<code class="descname">difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Elements from this Group that do not appear in another</p>
<p>This method removes duplicate elements and sorts the result. As such,
it is different from <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.subtract" title="MDAnalysis.core.groups.ResidueGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>. <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> is synomymous
to the <cite>-</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.subtract" title="MDAnalysis.core.groups.ResidueGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.symmetric_difference" title="MDAnalysis.core.groups.ResidueGroup.symmetric_difference"><code class="xref py py-meth docutils literal"><span class="pre">symmetric_difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.groupby">
<code class="descname">groupby</code><span class="sig-paren">(</span><em>topattr</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together items in this group according to values of <em>topattr</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topattr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Topology attribute to group components by.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Unique values of the topology attribute as keys, Groups as values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>To group atoms with the same mass together:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
<span class="go">{12.010999999999999: &lt;AtomGroup with 462 atoms&gt;,</span>
<span class="go">14.007: &lt;AtomGroup with 116 atoms&gt;,</span>
<span class="go">15.999000000000001: &lt;AtomGroup with 134 atoms&gt;}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are in both this Group and another</p>
<p>This method removes duplicate elements and sorts the result. It is
synomymous to the <cite>&amp;</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the common elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Intersections can be used when the select atoms string would
become too complicated.  For example to find the water atoms
which are within 4.0A of two segments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell1</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;around 4.0 segid 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell2</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;around 4.0 segid 2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">common</span> <span class="o">=</span> <span class="n">shell1</span> <span class="o">&amp;</span> <span class="n">shell2</span>  <span class="c1"># or shell1.intersection(shell2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.union" title="MDAnalysis.core.groups.ResidueGroup.union"><code class="xref py py-meth docutils literal"><span class="pre">union()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.is_strict_subset">
<code class="descname">is_strict_subset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.is_strict_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a subset of another Group but not identical</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a strict subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.is_strict_superset">
<code class="descname">is_strict_superset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.is_strict_superset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a superset of another Group but not identical</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a strict superset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.isdisjoint">
<code class="descname">isdisjoint</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>If the Group has no elements in common with the other Group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if the two Groups do not have common elements</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.issubset">
<code class="descname">issubset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of this Group are part of another Group</p>
<p>Note that an empty group is a subset of any group of the same level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.issuperset">
<code class="descname">issuperset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of another Group are part of this Group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.ix">
<code class="descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<ul class="simple">
<li>If this Group is an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>, these are the
indices of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> instances.</li>
<li>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal"><span class="pre">Residue</span></code></a> instances.</li>
<li>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal"><span class="pre">Segment</span></code></a> instances.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.ix_array">
<code class="descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<p>For a Group, ix_array is the same as ix. This method gives a
consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.ix" title="MDAnalysis.core.groups.ResidueGroup.ix"><code class="xref py py-obj docutils literal"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms represented in <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>, including
duplicate residues.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self.atoms)</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.n_residues">
<code class="descname">n_residues</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.n_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of residues in ResidueGroup. Equivalent to <code class="docutils literal"><span class="pre">len(self)</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.n_segments">
<code class="descname">n_segments</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.n_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unique segments represented in the ResidueGroup.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self.segments)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.pack_into_box">
<code class="descname">pack_into_box</code><span class="sig-paren">(</span><em>box=None</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift all atoms in this group to be within the primary unit cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>box</strong> (<em>array_like</em>) &#8211; Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>, uses these
timestep dimensions.</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; <code class="docutils literal"><span class="pre">True</span></code> to change coordinates in place.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> &#8211; Shifted atom coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>All atoms will be moved so that they lie between 0 and boxlength
<span class="math">\(L_i\)</span> in all dimensions, i.e. the lower left corner of the
simulation box is taken to be at (0,0,0):</p>
<div class="math">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\]</div>
<p>The default is to take unit cell information from the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> instance. The optional
argument <cite>box</cite> can be used to provide alternative unit cell information
(in the MDAnalysis standard format <code class="docutils literal"><span class="pre">[Lx,</span> <span class="pre">Ly,</span> <span class="pre">Lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span>
<span class="pre">gamma]</span></code>).</p>
<p>Works with either orthogonal or triclinic box types.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.residues">
<code class="descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a> identical to this one.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>R</em>, <em>point=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation matrix <cite>R</cite> to the selection&#8217;s coordinates.
<span class="math">\(\mathsf{R}\)</span> is a 3x3 orthogonal matrix that transforms a vector
<span class="math">\(\mathbf{x} \rightarrow \mathbf{x}'\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\mathbf{x}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>R</strong> (<em>array_like</em>) &#8211; 3x3 rotation matrix to use for applying rotation.</li>
<li><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) &#8211; Center of rotation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>By default rotates around center of origin <code class="docutils literal"><span class="pre">point=(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>. To
rotate around center of geometry of the atomgroup use <code class="docutils literal"><span class="pre">ag.rotate(R,</span>
<span class="pre">point=ag.centroid)</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.rotateby" title="MDAnalysis.core.groups.ResidueGroup.rotateby"><code class="xref py py-meth docutils literal"><span class="pre">rotateby()</span></code></a></dt>
<dd>rotate around given axis and angle</dd>
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.rotateby">
<code class="descname">rotateby</code><span class="sig-paren">(</span><em>angle</em>, <em>axis</em>, <em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.rotateby" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation to the selection&#8217;s coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Rotation angle in degrees.</li>
<li><strong>axis</strong> (<em>array_like</em>) &#8211; Rotation axis vector.</li>
<li><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) &#8211; Center of rotation. If <code class="docutils literal"><span class="pre">None</span></code> then the center of geometry of this
group is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The transformation from current coordinates <span class="math">\(\mathbf{x}\)</span>
to new coordinates <span class="math">\(\mathbf{x}'\)</span> is</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\,(\mathbf{x}-\mathbf{p}) + \mathbf{p}\]</div>
<p>where <span class="math">\(\mathsf{R}\)</span> is the rotation by <cite>angle</cite> around the
<cite>axis</cite> going through <cite>point</cite> <span class="math">\(\mathbf{p}\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations.rotation_matrix()</span></code></dt>
<dd>calculate <span class="math">\(\mathsf{R}\)</span></dd>
</dl>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.segments">
<code class="descname">segments</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sorted SegmentGroup of the (unique) segments represented in the
ResidueGroup.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.subtract">
<code class="descname">subtract</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Group with elements from this Group that don&#8217;t appear in other</p>
<p>The original order of this group is kept, as well as any duplicate
elements. If an element of this Group is duplicated and appears in
the other Group or Component, then all the occurences of that element
are removed from the returned Group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>,
conserves order and duplicates.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Unlike <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> this method will not sort or remove
duplicates.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">-</span> <span class="n">ag2</span>  <span class="c1"># or ag1.subtract(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span><span class="o">.</span><span class="n">indices</span>
<span class="go">array([3, 3, 1, 1])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="MDAnalysis.core.groups.ResidueGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.symmetric_difference">
<code class="descname">symmetric_difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are only in one of this Group or another</p>
<p>This method removes duplicate elements and the result is sorted. It is
synomym to the <cite>^</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements that are in <cite>self</cite> or in <cite>other</cite> but not in
both, without duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">^</span> <span class="n">ag2</span>  <span class="c1"># or ag1.symmetric_difference(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="o">.</span><span class="n">indices</span>  <span class="c1"># 0 and 1 are only in ag1, 4 and 6 are only in ag2</span>
<span class="go">[0, 1, 4, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply homogenous transformation matrix <cite>M</cite> to the coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; 4x4 matrix, with the rotation in <code class="docutils literal"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">M[:3,:3]</span></code> and the
translation in <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">M[:3,3]</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation <span class="math">\(\mathsf{R}\)</span> is applied before the translation
<span class="math">\(\mathbf{t}\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply translation vector <cite>t</cite> to the selection&#8217;s coordinates.</p>
<p>Atom coordinates are translated in-place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> (<em>array_like</em>) &#8211; vector to translate coordinates with</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The method applies a translation to the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>
from current coordinates <span class="math">\(\mathbf{x}\)</span> to new coordinates
<span class="math">\(\mathbf{x}'\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.union">
<code class="descname">union</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements either in this Group or another</p>
<p>On the contrary to concatenation, this method sort the elements and
removes duplicate ones. It is synomymous to the <cite>|</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the combined elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>In contrast to <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="MDAnalysis.core.groups.ResidueGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, any duplicates are dropped
and the result is sorted.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag1.union(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;O&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="MDAnalysis.core.groups.ResidueGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.intersection" title="MDAnalysis.core.groups.ResidueGroup.intersection"><code class="xref py py-meth docutils literal"><span class="pre">intersection()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.ResidueGroup.unique">
<code class="descname">unique</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a ResidueGroup containing sorted and unique residues only.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span>
<span class="go">&lt;ResidueGroup with 6 residues&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([2, 1, 2, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span>
<span class="go">&lt;ResidueGroup with 3 residues&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([0, 1, 2])</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.wrap">
<code class="descname">wrap</code><span class="sig-paren">(</span><em>compound='atoms'</em>, <em>center='com'</em>, <em>box=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the contents of this Group back into the unit cell.</p>
<p>This is a more powerful version of <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal"><span class="pre">pack_into_box()</span></code></a>, allowing
groups of atoms to be kept together through the process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>compound</strong> (<em>{'atoms'</em><em>, </em><em>'group'</em><em>, </em><em>'residues'</em><em>, </em><em>'segments'</em><em>, </em><em>'fragments'}</em>) &#8211; The group which will be kept together through the shifting process.</li>
<li><strong>center</strong> (<em>{'com'</em><em>, </em><em>'cog'}</em>) &#8211; How to define the center of a given group of atoms.</li>
<li><strong>box</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>, uses these
timestep dimensions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>When specifying a <cite>compound</cite>, the translation is calculated based on
each compound. The same translation is applied to all atoms
within this compound, meaning it will not be broken by the shift.
This might however mean that all atoms from the compound are not
inside the unit cell, but rather the center of the compound is.</p>
<p><cite>center</cite> allows the definition of the center of each group to be
specified. This can be either &#8216;com&#8217; for center of mass, or &#8216;cog&#8217; for
center of geometry.</p>
<p><cite>box</cite> allows a unit cell to be given for the transformation. If not
specified, an the dimensions information from the current Timestep will
be used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">wrap with all default keywords is identical to <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal"><span class="pre">pack_into_box()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.2.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.SegmentGroup">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">SegmentGroup</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#SegmentGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>SegmentGroup base class.</p>
<p>This class is used by a Universe for generating its Topology-specific
SegmentGroup class. All the TopologyAttr components are obtained from
GroupBase, so this class only includes ad-hoc methods specific to
SegmentGroups.</p>
<p>SegmentGroups can be compared and combined using group operators. See the
list of these operators on <code class="xref py py-class docutils literal"><span class="pre">GroupBase</span></code>.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of Segments will be removed in the 1.0 release.
See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details and alternatives.</p>
</div>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an AtomGroup of atoms represented in this SegmentGroup.</p>
<p>The atoms are ordered locally by residue, which are further ordered by
segment in the SegmentGroup. No duplicates are removed.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.bbox">
<code class="descname">bbox</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding box of the selection.</p>
<p>The lengths A,B,C of the orthorhombic enclosing box are</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">bbox</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, move all atoms within the primary unit cell before
calculation. [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>corners</strong> &#8211; 2x3 array giving corners of bounding box as
[[xmin, ymin, zmin], [xmax, ymax, zmax]].</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.bsphere">
<code class="descname">bsphere</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.bsphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding sphere of the selection.</p>
<p>The sphere is calculated relative to the centre of geometry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, move all atoms within the primary unit cell before
calculation. [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>R</strong> (<em>float</em>) &#8211; Radius of bounding sphere.</li>
<li><strong>center</strong> (<em>array</em>) &#8211; Coordinates of sphere center as <code class="docutils literal"><span class="pre">[xcen,ycen,zcen]</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.center">
<code class="descname">center</code><span class="sig-paren">(</span><em>weights</em>, <em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate center of group given some weights</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>weights</strong> (<em>array_like</em>) &#8211; weights to be used</li>
<li><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>center</strong> &#8211; weighted center of group</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To find the charge weighted center of a given Atomgroup:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.center_of_geometry">
<code class="descname">center_of_geometry</code><span class="sig-paren">(</span><em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry (also known as centroid) of the selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>center</strong> &#8211; geometric center of group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><em>pbc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry (also known as centroid) of the selection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pbc</strong> (<em>boolean</em><em>, </em><em>optional</em>) &#8211; <code class="docutils literal"><span class="pre">True</span></code>: Move all atoms within the primary unit cell
before calculation [<code class="docutils literal"><span class="pre">False</span></code>]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>center</strong> &#8211; geometric center of group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.concatenate">
<code class="descname">concatenate</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate with another Group or Component of the same level.</p>
<p>Duplicate entries and original order is preserved. It is synomymous to
the <cite>+</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with elements of <cite>self</cite> and <cite>other</cite> concatenated</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>The order of the original contents (including duplicates)
are preserved when performing a concatenation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag1.concatenate(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;O&#39;, &#39;O&#39;, &#39;O&#39;], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;N&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.difference">
<code class="descname">difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Elements from this Group that do not appear in another</p>
<p>This method removes duplicate elements and sorts the result. As such,
it is different from <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.subtract" title="MDAnalysis.core.groups.SegmentGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>. <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> is synomymous
to the <cite>-</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.subtract" title="MDAnalysis.core.groups.SegmentGroup.subtract"><code class="xref py py-meth docutils literal"><span class="pre">subtract()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.symmetric_difference" title="MDAnalysis.core.groups.SegmentGroup.symmetric_difference"><code class="xref py py-meth docutils literal"><span class="pre">symmetric_difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.groupby">
<code class="descname">groupby</code><span class="sig-paren">(</span><em>topattr</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together items in this group according to values of <em>topattr</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topattr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; Topology attribute to group components by.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Unique values of the topology attribute as keys, Groups as values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>To group atoms with the same mass together:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
<span class="go">{12.010999999999999: &lt;AtomGroup with 462 atoms&gt;,</span>
<span class="go">14.007: &lt;AtomGroup with 116 atoms&gt;,</span>
<span class="go">15.999000000000001: &lt;AtomGroup with 134 atoms&gt;}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are in both this Group and another</p>
<p>This method removes duplicate elements and sorts the result. It is
synomymous to the <cite>&amp;</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the common elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Intersections can be used when the select atoms string would
become too complicated.  For example to find the water atoms
which are within 4.0A of two segments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell1</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;around 4.0 segid 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell2</span> <span class="o">=</span> <span class="n">water</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;around 4.0 segid 2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">common</span> <span class="o">=</span> <span class="n">shell1</span> <span class="o">&amp;</span> <span class="n">shell2</span>  <span class="c1"># or shell1.intersection(shell2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.union" title="MDAnalysis.core.groups.SegmentGroup.union"><code class="xref py py-meth docutils literal"><span class="pre">union()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.is_strict_subset">
<code class="descname">is_strict_subset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.is_strict_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a subset of another Group but not identical</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a strict subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.is_strict_superset">
<code class="descname">is_strict_superset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.is_strict_superset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a superset of another Group but not identical</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a strict superset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.isdisjoint">
<code class="descname">isdisjoint</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>If the Group has no elements in common with the other Group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if the two Groups do not have common elements</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.issubset">
<code class="descname">issubset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of this Group are part of another Group</p>
<p>Note that an empty group is a subset of any group of the same level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.issuperset">
<code class="descname">issuperset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of another Group are part of this Group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Bool</em> &#8211; True if this Group is a subset of the other one</li>
<li><em>.. versionadded:: 0.16</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.ix">
<code class="descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<ul class="simple">
<li>If this Group is an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>, these are the
indices of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal"><span class="pre">Atom</span></code></a> instances.</li>
<li>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal"><span class="pre">Residue</span></code></a> instances.</li>
<li>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal"><span class="pre">Segment</span></code></a> instances.</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.ix_array">
<code class="descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<p>For a Group, ix_array is the same as ix. This method gives a
consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.ix" title="MDAnalysis.core.groups.SegmentGroup.ix"><code class="xref py py-obj docutils literal"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms represented in SegmentGroup, including duplicate
segments.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self.atoms)</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.n_residues">
<code class="descname">n_residues</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.n_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of residues represented in SegmentGroup, including duplicate
segments.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">len(self.residues)</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.n_segments">
<code class="descname">n_segments</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.n_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of segments in SegmentGroup. Equivalent to <code class="docutils literal"><span class="pre">len(self)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.pack_into_box">
<code class="descname">pack_into_box</code><span class="sig-paren">(</span><em>box=None</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift all atoms in this group to be within the primary unit cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>box</strong> (<em>array_like</em>) &#8211; Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>, uses these
timestep dimensions.</li>
<li><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; <code class="docutils literal"><span class="pre">True</span></code> to change coordinates in place.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coords</strong> &#8211; Shifted atom coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>All atoms will be moved so that they lie between 0 and boxlength
<span class="math">\(L_i\)</span> in all dimensions, i.e. the lower left corner of the
simulation box is taken to be at (0,0,0):</p>
<div class="math">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\]</div>
<p>The default is to take unit cell information from the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> instance. The optional
argument <cite>box</cite> can be used to provide alternative unit cell information
(in the MDAnalysis standard format <code class="docutils literal"><span class="pre">[Lx,</span> <span class="pre">Ly,</span> <span class="pre">Lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span>
<span class="pre">gamma]</span></code>).</p>
<p>Works with either orthogonal or triclinic box types.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.residues">
<code class="descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a ResidueGroup of residues represented in this SegmentGroup.</p>
<p>The residues are ordered locally by segment in the SegmentGroup.
No duplicates are removed.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>R</em>, <em>point=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation matrix <cite>R</cite> to the selection&#8217;s coordinates.
<span class="math">\(\mathsf{R}\)</span> is a 3x3 orthogonal matrix that transforms a vector
<span class="math">\(\mathbf{x} \rightarrow \mathbf{x}'\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\mathbf{x}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>R</strong> (<em>array_like</em>) &#8211; 3x3 rotation matrix to use for applying rotation.</li>
<li><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) &#8211; Center of rotation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>By default rotates around center of origin <code class="docutils literal"><span class="pre">point=(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>. To
rotate around center of geometry of the atomgroup use <code class="docutils literal"><span class="pre">ag.rotate(R,</span>
<span class="pre">point=ag.centroid)</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.rotateby" title="MDAnalysis.core.groups.SegmentGroup.rotateby"><code class="xref py py-meth docutils literal"><span class="pre">rotateby()</span></code></a></dt>
<dd>rotate around given axis and angle</dd>
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.rotateby">
<code class="descname">rotateby</code><span class="sig-paren">(</span><em>angle</em>, <em>axis</em>, <em>point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.rotateby" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation to the selection&#8217;s coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Rotation angle in degrees.</li>
<li><strong>axis</strong> (<em>array_like</em>) &#8211; Rotation axis vector.</li>
<li><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) &#8211; Center of rotation. If <code class="docutils literal"><span class="pre">None</span></code> then the center of geometry of this
group is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>self</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The transformation from current coordinates <span class="math">\(\mathbf{x}\)</span>
to new coordinates <span class="math">\(\mathbf{x}'\)</span> is</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\,(\mathbf{x}-\mathbf{p}) + \mathbf{p}\]</div>
<p>where <span class="math">\(\mathsf{R}\)</span> is the rotation by <cite>angle</cite> around the
<cite>axis</cite> going through <cite>point</cite> <span class="math">\(\mathbf{p}\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations.rotation_matrix()</span></code></dt>
<dd>calculate <span class="math">\(\mathsf{R}\)</span></dd>
</dl>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.segments">
<code class="descname">segments</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another SegmentGroup identical to this one.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.subtract">
<code class="descname">subtract</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Group with elements from this Group that don&#8217;t appear in other</p>
<p>The original order of this group is kept, as well as any duplicate
elements. If an element of this Group is duplicated and appears in
the other Group or Component, then all the occurences of that element
are removed from the returned Group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>,
conserves order and duplicates.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Unlike <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a> this method will not sort or remove
duplicates.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">-</span> <span class="n">ag2</span>  <span class="c1"># or ag1.subtract(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span><span class="o">.</span><span class="n">indices</span>
<span class="go">array([3, 3, 1, 1])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="MDAnalysis.core.groups.SegmentGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.symmetric_difference">
<code class="descname">symmetric_difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are only in one of this Group or another</p>
<p>This method removes duplicate elements and the result is sorted. It is
synomym to the <cite>^</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the elements that are in <cite>self</cite> or in <cite>other</cite> but not in
both, without duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">^</span> <span class="n">ag2</span>  <span class="c1"># or ag1.symmetric_difference(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="o">.</span><span class="n">indices</span>  <span class="c1"># 0 and 1 are only in ag1, 4 and 6 are only in ag2</span>
<span class="go">[0, 1, 4, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal"><span class="pre">difference()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply homogenous transformation matrix <cite>M</cite> to the coordinates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>M</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; 4x4 matrix, with the rotation in <code class="docutils literal"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">M[:3,:3]</span></code> and the
translation in <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">M[:3,3]</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation <span class="math">\(\mathsf{R}\)</span> is applied before the translation
<span class="math">\(\mathbf{t}\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathsf{R}\mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply translation vector <cite>t</cite> to the selection&#8217;s coordinates.</p>
<p>Atom coordinates are translated in-place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> (<em>array_like</em>) &#8211; vector to translate coordinates with</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt>
<dd>module of all coordinate transforms</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The method applies a translation to the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>
from current coordinates <span class="math">\(\mathbf{x}\)</span> to new coordinates
<span class="math">\(\mathbf{x}'\)</span>:</p>
<div class="math">
\[\mathbf{x}' = \mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.union">
<code class="descname">union</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements either in this Group or another</p>
<p>On the contrary to concatenation, this method sort the elements and
removes duplicate ones. It is synomymous to the <cite>|</cite> operator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) &#8211; Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Group with the combined elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Group</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>In contrast to <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="MDAnalysis.core.groups.SegmentGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, any duplicates are dropped
and the result is sorted.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag1.union(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;O&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="MDAnalysis.core.groups.SegmentGroup.concatenate"><code class="xref py py-meth docutils literal"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.intersection" title="MDAnalysis.core.groups.SegmentGroup.intersection"><code class="xref py py-meth docutils literal"><span class="pre">intersection()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">()</span></code></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.SegmentGroup.unique">
<code class="descname">unique</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a SegmentGroup containing sorted and unique segments only.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">segments</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span>
<span class="go">&lt;SegmentGroup with 6 segments&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([2, 1, 2, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span>
<span class="go">&lt;SegmentGroup with 3 segments&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([0, 1, 2])</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.wrap">
<code class="descname">wrap</code><span class="sig-paren">(</span><em>compound='atoms'</em>, <em>center='com'</em>, <em>box=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the contents of this Group back into the unit cell.</p>
<p>This is a more powerful version of <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal"><span class="pre">pack_into_box()</span></code></a>, allowing
groups of atoms to be kept together through the process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>compound</strong> (<em>{'atoms'</em><em>, </em><em>'group'</em><em>, </em><em>'residues'</em><em>, </em><em>'segments'</em><em>, </em><em>'fragments'}</em>) &#8211; The group which will be kept together through the shifting process.</li>
<li><strong>center</strong> (<em>{'com'</em><em>, </em><em>'cog'}</em>) &#8211; How to define the center of a given group of atoms.</li>
<li><strong>box</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>, uses these
timestep dimensions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>When specifying a <cite>compound</cite>, the translation is calculated based on
each compound. The same translation is applied to all atoms
within this compound, meaning it will not be broken by the shift.
This might however mean that all atoms from the compound are not
inside the unit cell, but rather the center of the compound is.</p>
<p><cite>center</cite> allows the definition of the center of each group to be
specified. This can be either &#8216;com&#8217; for center of mass, or &#8216;cog&#8217; for
center of geometry.</p>
<p><cite>box</cite> allows a unit cell to be given for the transformation. If not
specified, an the dimensions information from the current Timestep will
be used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">wrap with all default keywords is identical to <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal"><span class="pre">pack_into_box()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.2.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">UpdatingAtomGroup</code><span class="sig-paren">(</span><em>base_group</em>, <em>selections</em>, <em>strings</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#UpdatingAtomGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> subclass that dynamically updates its selected atoms.</p>
<p>Accessing any attribute/method of an <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal"><span class="pre">UpdatingAtomGroup</span></code></a> instance
triggers a check for the last frame the group was updated. If the last
frame matches the current trajectory frame, the attribute is returned
normally; otherwise the group is updated (the stored selections are
re-applied), and only then is the attribute returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.16.0.</span></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>base_group</strong> (<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>) &#8211; group on which <em>selections</em> are to be applied.</li>
<li><strong>selections</strong> (a tuple of <code class="xref py py-class docutils literal"><span class="pre">Selection</span></code>) &#8211; instances selections ready to be applied to <em>base_group</em>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate">
<code class="descname">is_uptodate</code><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the selection needs updating based on frame number only.</p>
<p>Modifications to the coordinate data that render selections stale are
not caught, and in those cases <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate" title="MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate"><code class="xref py py-attr docutils literal"><span class="pre">is_uptodate</span></code></a> may return an
erroneous value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><cite>True</cite> if the group&#8217;s selection is up-to-date, <cite>False</cite> otherwise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup.update_selection">
<code class="descname">update_selection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#UpdatingAtomGroup.update_selection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup.update_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces the reevaluation and application of the group&#8217;s selection(s).</p>
<p>This method is triggered automatically when accessing attributes, if
the last update occurred under a different trajectory frame.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="chemical-units">
<h3>9.1.2.1.2. Chemical units<a class="headerlink" href="#chemical-units" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="MDAnalysis.core.groups.Atom">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>ix</em>, <em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom base class.</p>
<p>This class is used by a Universe for generating its Topology-specific Atom
class. All the TopologyAttr components are obtained from ComponentBase, so
this class only includes ad-hoc methods specific to Atoms.</p>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.Atom.force">
<code class="descname">force</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.force" title="Permalink to this definition">¶</a></dt>
<dd><p>Force on the atom.</p>
<p>The force can be changed by assigning an array of shape (3,).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">changing the force is not reflected in any files; reading any
frame from the trajectory will replace the change with that
from the file</p>
</div>
<p>A <code class="xref py py-exc docutils literal"><span class="pre">NoDataError</span></code> is raised if the trajectory
does not contain forces.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.Atom.ix">
<code class="descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component.</p>
<p>If this component is an Atom, this is the index of the atom.
If it is a Residue, this is the index of the residue.
If it is a Segment, this is the index of the segment.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.Atom.ix_array">
<code class="descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component as an array.</p>
<p>This method gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.Atom.ix" title="MDAnalysis.core.groups.Atom.ix"><code class="xref py py-obj docutils literal"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.Atom.position">
<code class="descname">position</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.position" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates of the atom.</p>
<p>The position can be changed by assigning an array of length (3,).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">changing the position is not reflected in any files; reading any
frame from the trajectory will replace the change with that
from the file</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.Atom.velocity">
<code class="descname">velocity</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocity of the atom.</p>
<p>The velocity can be changed by assigning an array of shape (3,).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">changing the velocity is not reflected in any files; reading any
frame from the trajectory will replace the change with that
from the file</p>
</div>
<p>A <code class="xref py py-exc docutils literal"><span class="pre">NoDataError</span></code> is raised if the trajectory
does not contain velocities.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.Residue">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">Residue</code><span class="sig-paren">(</span><em>ix</em>, <em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#Residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Residue base class.</p>
<p>This class is used by a Universe for generating its Topology-specific
Residue class. All the TopologyAttr components are obtained from
ComponentBase, so this class only includes ad-hoc methods specific to
Residues.</p>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.Residue.ix">
<code class="descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.Residue.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component.</p>
<p>If this component is an Atom, this is the index of the atom.
If it is a Residue, this is the index of the residue.
If it is a Segment, this is the index of the segment.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.Residue.ix_array">
<code class="descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.Residue.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component as an array.</p>
<p>This method gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.Residue.ix" title="MDAnalysis.core.groups.Residue.ix"><code class="xref py py-obj docutils literal"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.Segment">
<em class="property">class </em><code class="descclassname">MDAnalysis.core.groups.</code><code class="descname">Segment</code><span class="sig-paren">(</span><em>ix</em>, <em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#Segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.Segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Segment base class.</p>
<p>This class is used by a Universe for generating its Topology-specific
Segment class. All the TopologyAttr components are obtained from
ComponentBase, so this class only includes ad-hoc methods specific to
Segments.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of Segments will be removed in the 1.0 release.
See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details and alternatives.</p>
</div>
<dl class="attribute">
<dt id="MDAnalysis.core.groups.Segment.ix">
<code class="descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.Segment.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component.</p>
<p>If this component is an Atom, this is the index of the atom.
If it is a Residue, this is the index of the residue.
If it is a Segment, this is the index of the segment.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.groups.Segment.ix_array">
<code class="descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.Segment.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component as an array.</p>
<p>This method gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.core.groups.Segment.ix" title="MDAnalysis.core.groups.Segment.ix"><code class="xref py py-obj docutils literal"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="levels">
<h3>9.1.2.1.3. Levels<a class="headerlink" href="#levels" title="Permalink to this headline">¶</a></h3>
<p>Each of the above classes has a level attribute.  This can be used to
verify that two objects are of the same level, or to access a particular
class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">()</span>

<span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>

<span class="n">ag</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">at</span><span class="o">.</span><span class="n">level</span>  <span class="c1"># Returns True</span>

<span class="n">ag</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">singular</span>  <span class="c1"># Returns Atom class</span>
<span class="n">at</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">plural</span>  <span class="c1"># Returns AtomGroup class</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a href="https://travis-ci.org/MDAnalysis/mdanalysis">
    <img
        alt="https://secure.travis-ci.org/MDAnalysis/mdanalysis.svg?branch=master"
        src="https://secure.travis-ci.org/MDAnalysis/mdanalysis.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">7. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">8. Auxiliary modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../core_modules.html">9. Core modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../core_modules.html#important-objects-for-users">9.1. Important objects for users</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="universe.html">9.1.1. Core object: Universe &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.core.universe</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">9.1.2. Core objects: Containers &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.core.groups</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#classes">9.1.2.1. Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#topology-system">9.2. Topology system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#selection-system">9.3. Selection system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#flag-system">9.4. Flag system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">10. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">11. Library functions &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">12. Version information for MDAnalysis - <code class="docutils literal"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">13. Constants and unit conversion &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">14. Custom exceptions and warnings &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">15. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../core_modules.html">9. Core modules</a><ul>
      <li>Previous: <a href="universe.html" title="previous chapter">9.1.1. Core object: Universe &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.core.universe</span></code></a></li>
      <li>Next: <a href="topology.html" title="next chapter">9.2.1. Core Topology object &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.core.topology</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Wouter Boomsma, Bart Bruininks, Sébastien Buchoux, David Caplan, Matthieu Chavent, Kathleen Clark, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Andrew William King, Max Linke, Jinju Lu, Robert McGibbon, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Vedant Rathore, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Xiki Tempula, Matteo Tiberti, Isaac Virshup, Zhuyi Xue, Juan Eiros Zamora, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/documentation_pages/core/groups.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>